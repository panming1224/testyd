# æ‹¼å¤šå¤šçˆ¬è™«ç³»ç»Ÿ - æ¶æ„æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£è¯´æ˜

**æœ¬æ–‡æ¡£ç›®çš„ï¼š**
- å¿«é€Ÿäº†è§£ç³»ç»ŸåŠŸèƒ½å’Œè°ƒç”¨æ–¹å¼
- é¿å…é‡å¤å¼€å‘
- æ–°å¢åŠŸèƒ½æ—¶æ›´æ–°æ­¤æ–‡æ¡£

**æœ€åæ›´æ–°ï¼š** 2025-10-03

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

1. **é…ç½®é©±åŠ¨** - æ‰€æœ‰çˆ¬è™«é…ç½®é›†ä¸­ç®¡ç†
2. **ä»»åŠ¡çŠ¶æ€ç®¡ç†** - ç²¾ç¡®çš„çŠ¶æ€è·Ÿè¸ªï¼ˆNULL/å¾…æ‰§è¡Œ/å·²å®Œæˆï¼‰
3. **åŸºç±»å¤ç”¨** - é€šç”¨åŠŸèƒ½å°è£…åœ¨åŸºç±»ä¸­
4. **æ˜“äºæ‰©å±•** - æ–°å¢çˆ¬è™«åªéœ€3æ­¥

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä»»åŠ¡è°ƒåº¦å±‚                              â”‚
â”‚  (Prefect/Cron) - å®šæ—¶è§¦å‘ä»»åŠ¡ç”Ÿæˆå’Œæ‰§è¡Œ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ä»»åŠ¡ç”Ÿæˆå™¨                                â”‚
â”‚  generate_tasks.py - æ ¹æ®é…ç½®ç”Ÿæˆå¾…æ‰§è¡Œä»»åŠ¡                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ•°æ®åº“ä»»åŠ¡è¡¨                              â”‚
â”‚  pdd_tasks - å­˜å‚¨ä»»åŠ¡çŠ¶æ€ï¼ˆå¾…æ‰§è¡Œ/å·²å®Œæˆï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  çˆ¬è™«æ‰§è¡Œå±‚                                â”‚
â”‚  å„ä¸ªçˆ¬è™«ç¨‹åº - è¯»å–å¾…æ‰§è¡Œä»»åŠ¡ï¼Œé‡‡é›†æ•°æ®ï¼Œæ›´æ–°çŠ¶æ€            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ•°æ®å­˜å‚¨å±‚                                â”‚
â”‚  MinIO + Dremio - æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
testyd/pdd/
â”œâ”€â”€ crawler_config.py          # ã€æ ¸å¿ƒã€‘çˆ¬è™«é…ç½®æ–‡ä»¶
â”œâ”€â”€ generate_tasks.py          # ã€æ ¸å¿ƒã€‘ä»»åŠ¡ç”Ÿæˆå™¨
â”œâ”€â”€ base_crawler.py            # ã€æ ¸å¿ƒã€‘çˆ¬è™«åŸºç±»
â”œâ”€â”€ pdd_badscore.py           # å·®è¯„æ•°æ®é‡‡é›†ï¼ˆT-1ï¼‰
â”œâ”€â”€ pdd_quality.py            # äº§å“è´¨é‡æ•°æ®é‡‡é›†ï¼ˆTï¼‰
â”œâ”€â”€ pdd_kpi.py                # å®¢æœç»©æ•ˆæ•°æ®é‡‡é›†ï¼ˆæ—¥åº¦ï¼ŒT-3ï¼‰
â”œâ”€â”€ pdd_kpi_weekly.py         # å®¢æœç»©æ•ˆæ•°æ®é‡‡é›†ï¼ˆå‘¨åº¦ï¼‰
â”œâ”€â”€ pdd_kpi_monthly.py        # å®¢æœç»©æ•ˆæ•°æ®é‡‡é›†ï¼ˆæœˆåº¦ï¼‰
â”œâ”€â”€ pdd_chat.py               # èŠå¤©æ•°æ®é‡‡é›†ï¼ˆT-1ï¼‰- å¾…å®ç°
â”œâ”€â”€ run_all_shops.py          # å®Œæ•´æµ‹è¯•è„šæœ¬
â””â”€â”€ æ¶æ„æ–‡æ¡£.md               # æœ¬æ–‡æ¡£
```

---

## ğŸ”§ æ ¸å¿ƒæ¨¡å—

### 1. crawler_config.py - é…ç½®ä¸­å¿ƒ

**åŠŸèƒ½ï¼š** é›†ä¸­ç®¡ç†æ‰€æœ‰çˆ¬è™«é…ç½®

**é…ç½®ç»“æ„ï¼š**
```python
CRAWLER_TASKS = {
    'task_key': {
        'name': 'ä»»åŠ¡åç§°',
        'script': 'è„šæœ¬æ–‡ä»¶å',
        'status_field': 'æ•°æ®åº“çŠ¶æ€å­—æ®µå',
        'schedule': 'daily/weekly/monthly',
        'date_offset': -1,  # æ—¥æœŸåç§»ï¼ˆT-1è¡¨ç¤ºæ˜¨å¤©ï¼‰
        'minio_path': 'MinIOå­˜å‚¨è·¯å¾„',
        'dremio_table': 'Dremioè¡¨å',
        'enabled': True/False
    }
}
```

**è°ƒç”¨æ–¹å¼ï¼š**
```python
from testyd.pdd.crawler_config import CRAWLER_TASKS, get_enabled_tasks

# è·å–æ‰€æœ‰å¯ç”¨çš„ä»»åŠ¡
enabled_tasks = get_enabled_tasks()

# è·å–ç‰¹å®šä»»åŠ¡é…ç½®
task_config = CRAWLER_TASKS['badscore']
```

**å½“å‰é…ç½®çš„ä»»åŠ¡ï¼š**

| ä»»åŠ¡Key | ä»»åŠ¡åç§° | æ—¥æœŸåç§» | çŠ¶æ€å­—æ®µ | è°ƒåº¦é¢‘ç‡ | çŠ¶æ€ |
|---------|---------|---------|---------|---------|------|
| badscore | å·®è¯„æ•°æ®é‡‡é›† | T-1 | badsscore_status | daily | âœ… å¯ç”¨ |
| quality | äº§å“è´¨é‡æ•°æ®é‡‡é›† | T | quality_status | daily | âœ… å¯ç”¨ |
| kpi_days | å®¢æœç»©æ•ˆæ•°æ®é‡‡é›†ï¼ˆæ—¥åº¦ï¼‰ | T-3 | kpi_days_status | daily | âœ… å¯ç”¨ |
| chat | èŠå¤©æ•°æ®é‡‡é›† | T-1 | chat_status | daily | âœ… å¯ç”¨ |
| kpi_weekly | å®¢æœç»©æ•ˆæ•°æ®é‡‡é›†ï¼ˆå‘¨åº¦ï¼‰ | T-9åˆ°T-3 | kpi_weekly_status | weekly | â¸ï¸ å¾…å®ç° |
| kpi_monthly | å®¢æœç»©æ•ˆæ•°æ®é‡‡é›†ï¼ˆæœˆåº¦ï¼‰ | ä¸Šæœˆ | kpi_monthly_status | monthly | â¸ï¸ å¾…å®ç° |

---

### 2. generate_tasks.py - ä»»åŠ¡ç”Ÿæˆå™¨

**åŠŸèƒ½ï¼š** æ ¹æ®é…ç½®ç”Ÿæˆå¾…æ‰§è¡Œä»»åŠ¡

**å‘½ä»¤è¡Œå‚æ•°ï¼š**
```bash
# ç”Ÿæˆæ¯æ—¥ä»»åŠ¡
python testyd/pdd/generate_tasks.py --schedule daily

# ç”Ÿæˆæ¯å‘¨ä»»åŠ¡
python testyd/pdd/generate_tasks.py --schedule weekly

# ç”Ÿæˆæ¯æœˆä»»åŠ¡
python testyd/pdd/generate_tasks.py --schedule monthly

# ç”Ÿæˆæ‰€æœ‰ä»»åŠ¡
python testyd/pdd/generate_tasks.py --schedule all

# æŒ‡å®šæ—¥æœŸç”Ÿæˆä»»åŠ¡ï¼ˆç”¨äºè¡¥æ•°æ®ï¼‰
python testyd/pdd/generate_tasks.py --schedule daily --date 2025-10-01
```

**æ ¸å¿ƒé€»è¾‘ï¼š**
1. è¯»å–é…ç½®æ–‡ä»¶ä¸­å¯ç”¨çš„ä»»åŠ¡
2. æ ¹æ®æ—¥æœŸåç§»è®¡ç®—ç›®æ ‡æ—¥æœŸ
3. ä½¿ç”¨ `INSERT IGNORE` + `UPDATE WHERE` ç²¾ç¡®æ›´æ–°çŠ¶æ€å­—æ®µ
4. åªæ›´æ–° NULL æˆ–ç©ºå€¼çš„å­—æ®µä¸º"å¾…æ‰§è¡Œ"ï¼Œå·²å®Œæˆçš„ä¿æŒä¸å˜

**è°ƒç”¨æ–¹å¼ï¼ˆPythonï¼‰ï¼š**
```python
from testyd.pdd.generate_tasks import generate_tasks_by_schedule

# ç”Ÿæˆæ¯æ—¥ä»»åŠ¡
results = generate_tasks_by_schedule('daily')

# ç”ŸæˆæŒ‡å®šæ—¥æœŸçš„ä»»åŠ¡
results = generate_tasks_by_schedule('daily', force_date='2025-10-01')
```

---

### 3. base_crawler.py - çˆ¬è™«åŸºç±»

**åŠŸèƒ½ï¼š** æä¾›é€šç”¨çš„çˆ¬è™«åŠŸèƒ½

**ä¸»è¦æ–¹æ³•ï¼š**

#### 3.1 è·å–å¾…å¤„ç†ä»»åŠ¡
```python
from testyd.pdd.base_crawler import BaseCrawler

class MyCrawler(BaseCrawler):
    def __init__(self):
        super().__init__(
            task_name='my_task',
            status_field='my_task_status',
            target_date='2025-10-03'
        )
    
    def run(self):
        # è·å–å¾…å¤„ç†ä»»åŠ¡
        pending_tasks = self.get_pending_tasks()
        
        for task in pending_tasks:
            shop_name = task['shop_name']
            cookie = task['cookie']
            
            # å¤„ç†ä»»åŠ¡
            self.process_shop(shop_name, cookie)
```

#### 3.2 æ›´æ–°ä»»åŠ¡çŠ¶æ€
```python
# æ›´æ–°ä¸ºå·²å®Œæˆ
self.update_task_status(shop_name, 'å·²å®Œæˆ')

# æ›´æ–°ä¸ºå¤±è´¥ï¼ˆä¿æŒå¾…æ‰§è¡ŒçŠ¶æ€ä¾¿äºé‡è¯•ï¼‰
# ä¸è°ƒç”¨update_task_statusï¼Œä»»åŠ¡ä¿æŒ"å¾…æ‰§è¡Œ"çŠ¶æ€
```

#### 3.3 æ–‡ä»¶åˆå¹¶
```python
# åˆå¹¶Excelæ–‡ä»¶
merged_file = self.merge_files(
    source_dir='D:/pdd/å·®è¯„æ•°æ®',
    output_dir='D:/pdd/åˆå¹¶æ–‡ä»¶',
    file_pattern='å·®è¯„*.xlsx',
    output_filename='å·®è¯„åˆå¹¶_2025-10-03.xlsx'
)
```

#### 3.4 MinIOä¸Šä¼ 
```python
# ä¸Šä¼ åˆ°MinIO
success = self.upload_to_minio(
    file_path=merged_file,
    minio_path='ods/pdd/pdd_badscore',
    date_partition='2025-10-03'
)
```

#### 3.5 Dremioåˆ·æ–°
```python
# åˆ·æ–°Dremioæ•°æ®é›†å’Œåå°„
self.refresh_dremio(
    table_name='minio.warehouse.ods.pdd.pdd_badscore'
)
```

---

### 4. æ•°æ®åº“æ¥å£

**ä½ç½®ï¼š** `testyd/mysql/crawler_db_interface.py`

**ä¸»è¦æ–¹æ³•ï¼š**

#### 4.1 ç”Ÿæˆä»»åŠ¡
```python
from testyd.mysql.crawler_db_interface import CrawlerDBInterface

db = CrawlerDBInterface()

# ç”Ÿæˆä»»åŠ¡
created_count = db.generate_tasks(
    time_period='2025-10-03',
    task_columns=['quality_status']
)
```

#### 4.2 è·å–å¾…å¤„ç†ä»»åŠ¡
```python
# è·å–å¾…å¤„ç†ä»»åŠ¡
pending_tasks = db.get_pending_tasks(
    time_period='2025-10-03',
    status_field='quality_status'
)
```

#### 4.3 æ›´æ–°ä»»åŠ¡çŠ¶æ€
```python
# æ›´æ–°ä»»åŠ¡çŠ¶æ€
db.update_task_status(
    time_period='2025-10-03',
    shop_name='361å—å®¸ä¸“å–åº—',
    status_field='quality_status',
    status='å·²å®Œæˆ'
)
```

---

## ğŸš€ æ–°å¢çˆ¬è™«æŒ‡å—

### æ­¥éª¤1ï¼šæ·»åŠ é…ç½®

åœ¨ `crawler_config.py` ä¸­æ·»åŠ é…ç½®ï¼š

```python
CRAWLER_TASKS = {
    # ... ç°æœ‰é…ç½® ...
    
    'new_task': {
        'name': 'æ–°ä»»åŠ¡åç§°',
        'script': 'pdd_new_task.py',
        'status_field': 'new_task_status',
        'schedule': 'daily',
        'date_offset': -1,  # T-1ï¼ˆæ˜¨å¤©ï¼‰
        'minio_path': 'ods/pdd/pdd_new_task',
        'dremio_table': 'minio.warehouse.ods.pdd.pdd_new_task',
        'enabled': True
    }
}
```

### æ­¥éª¤2ï¼šæ·»åŠ æ•°æ®åº“å­—æ®µ

```sql
ALTER TABLE pdd_tasks 
ADD COLUMN new_task_status VARCHAR(20) DEFAULT NULL;
```

### æ­¥éª¤3ï¼šåˆ›å»ºçˆ¬è™«è„šæœ¬

```python
# pdd_new_task.py
from testyd.pdd.base_crawler import BaseCrawler
from datetime import datetime, timedelta

class NewTaskCrawler(BaseCrawler):
    def __init__(self):
        target_date = (datetime.now() - timedelta(days=1)).strftime('%Y-%m-%d')
        super().__init__(
            task_name='æ–°ä»»åŠ¡',
            status_field='new_task_status',
            target_date=target_date
        )
    
    def process_shop(self, shop_name, cookie):
        """å®ç°å…·ä½“çš„æ•°æ®é‡‡é›†é€»è¾‘"""
        # 1. é‡‡é›†æ•°æ®
        data = self.crawl_data(shop_name, cookie)
        
        # 2. ä¿å­˜æ•°æ®
        self.save_data(data, shop_name)
        
        return True
    
    def run(self):
        """ä¸»æ‰§è¡Œæµç¨‹"""
        pending_tasks = self.get_pending_tasks()
        
        for task in pending_tasks:
            try:
                success = self.process_shop(task['shop_name'], task['cookie'])
                if success:
                    self.update_task_status(task['shop_name'], 'å·²å®Œæˆ')
            except Exception as e:
                print(f"å¤„ç†å¤±è´¥: {e}")
                # ä¿æŒå¾…æ‰§è¡ŒçŠ¶æ€ä¾¿äºé‡è¯•

if __name__ == '__main__':
    crawler = NewTaskCrawler()
    crawler.run()
```

**å®Œæˆï¼** æ— éœ€ä¿®æ”¹ä»»ä½•æ ¸å¿ƒä»£ç ï¼

---

## ğŸ“Š ä»»åŠ¡çŠ¶æ€ç®¡ç†

### çŠ¶æ€æµè½¬

```
NULLï¼ˆæ— ä»»åŠ¡ï¼‰
  â†“ ä»»åŠ¡ç”Ÿæˆå™¨
å¾…æ‰§è¡Œ
  â†“ çˆ¬è™«ç¨‹åºï¼ˆæˆåŠŸï¼‰
å·²å®Œæˆ
  
  â†“ çˆ¬è™«ç¨‹åºï¼ˆå¤±è´¥ï¼‰
å¾…æ‰§è¡Œï¼ˆä¿æŒä¸å˜ï¼Œä¾¿äºé‡è¯•ï¼‰
```

### çŠ¶æ€è¯´æ˜

| çŠ¶æ€å€¼ | å«ä¹‰ | è¯´æ˜ |
|--------|------|------|
| NULL | æ— ä»»åŠ¡ | è¯¥åº—é“ºè¯¥æ—¥æœŸä¸éœ€è¦æ‰§è¡Œæ­¤ä»»åŠ¡ |
| "å¾…æ‰§è¡Œ" | å¾…å¤„ç† | ä»»åŠ¡å·²ç”Ÿæˆï¼Œç­‰å¾…æ‰§è¡Œ |
| "å·²å®Œæˆ" | å·²å®Œæˆ | ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ |

### æ ¸å¿ƒè®¾è®¡

**ç²¾ç¡®çš„çŠ¶æ€ç®¡ç†ï¼š**
- ä½¿ç”¨ `INSERT IGNORE` + `UPDATE WHERE` ç²¾ç¡®æ§åˆ¶æ¯ä¸ªå­—æ®µ
- ä¸åŒä»»åŠ¡ç±»å‹çš„çŠ¶æ€å­—æ®µå®Œå…¨ç‹¬ç«‹
- ä¾‹å¦‚ï¼š`2025-10-02` åªæœ‰ `badsscore_status='å¾…æ‰§è¡Œ'`ï¼Œå…¶ä»–å­—æ®µä¸ºNULL

**ç¤ºä¾‹ï¼š**
```
æ—¥æœŸ         åº—é“º          å·®è¯„çŠ¶æ€    è´¨é‡çŠ¶æ€    ç»©æ•ˆçŠ¶æ€    èŠå¤©çŠ¶æ€
2025-10-02  361å—å®¸ä¸“å–åº—  å¾…æ‰§è¡Œ      NULL       NULL       å¾…æ‰§è¡Œ
2025-10-03  361å—å®¸ä¸“å–åº—  NULL       å¾…æ‰§è¡Œ      NULL       NULL
2025-09-30  361å—å®¸ä¸“å–åº—  NULL       NULL       å¾…æ‰§è¡Œ      NULL
```

---

## ğŸ” å¸¸ç”¨æ“ä½œ

### æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

```python
from testyd.mysql.crawler_db_interface import CrawlerDBInterface

db = CrawlerDBInterface()
conn = db.pool.connection()
cursor = conn.cursor()

# æŸ¥è¯¢æŸä¸ªæ—¥æœŸçš„ä»»åŠ¡çŠ¶æ€
cursor.execute("""
    SELECT 
        shop_name,
        quality_status,
        badsscore_status,
        kpi_days_status,
        chat_status
    FROM pdd_tasks
    WHERE time_period = '2025-10-03'
    LIMIT 10
""")

results = cursor.fetchall()
for row in results:
    print(row)

conn.close()
```

### é‡ç½®ä»»åŠ¡çŠ¶æ€

```python
# é‡ç½®æŸä¸ªæ—¥æœŸçš„æŸä¸ªä»»åŠ¡ç±»å‹
cursor.execute("""
    UPDATE pdd_tasks
    SET quality_status = 'å¾…æ‰§è¡Œ'
    WHERE time_period = '2025-10-03'
      AND quality_status = 'å·²å®Œæˆ'
""")
conn.commit()
```

### æ¸…ç†å†å²æ•°æ®

```python
# åˆ é™¤30å¤©å‰çš„æ•°æ®
cursor.execute("""
    DELETE FROM pdd_tasks
    WHERE time_period < DATE_SUB(CURDATE(), INTERVAL 30 DAY)
""")
conn.commit()
```

---

## ğŸ“ ç»´æŠ¤æŒ‡å—

### æ—¥å¸¸ç»´æŠ¤

1. **ç›‘æ§ä»»åŠ¡æ‰§è¡Œ**
   - æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
   - æŸ¥è¯¢æ•°æ®åº“ä»»åŠ¡çŠ¶æ€
   - ç›‘æ§MinIOä¸Šä¼ æƒ…å†µ

2. **å¤„ç†å¤±è´¥ä»»åŠ¡**
   - å¤±è´¥ä»»åŠ¡ä¿æŒ"å¾…æ‰§è¡Œ"çŠ¶æ€
   - é‡æ–°è¿è¡Œçˆ¬è™«ç¨‹åºå³å¯é‡è¯•

3. **æ¸…ç†å†å²æ•°æ®**
   - å®šæœŸæ¸…ç†30å¤©å‰çš„ä»»åŠ¡è®°å½•
   - å®šæœŸæ¸…ç†æœ¬åœ°æ–‡ä»¶

### æ•…éšœæ’æŸ¥

**é—®é¢˜1ï¼šä»»åŠ¡æ²¡æœ‰ç”Ÿæˆ**
- æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­ `enabled` æ˜¯å¦ä¸º `True`
- æ£€æŸ¥æ•°æ®åº“å­—æ®µæ˜¯å¦å­˜åœ¨
- æŸ¥çœ‹ä»»åŠ¡ç”Ÿæˆå™¨æ—¥å¿—

**é—®é¢˜2ï¼šä»»åŠ¡çŠ¶æ€æ²¡æœ‰æ›´æ–°**
- æ£€æŸ¥çˆ¬è™«ç¨‹åºæ˜¯å¦è°ƒç”¨äº† `update_task_status`
- æ£€æŸ¥æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸
- æŸ¥çœ‹çˆ¬è™«ç¨‹åºæ—¥å¿—

**é—®é¢˜3ï¼šMinIOä¸Šä¼ å¤±è´¥**
- æ£€æŸ¥MinIOæœåŠ¡æ˜¯å¦è¿è¡Œ
- æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥

---

## ğŸ¯ æœ€ä½³å®è·µ

1. **é…ç½®ä¼˜å…ˆ** - æ‰€æœ‰é…ç½®éƒ½åœ¨ `crawler_config.py` ä¸­ç®¡ç†
2. **çŠ¶æ€é©±åŠ¨** - é€šè¿‡ä»»åŠ¡çŠ¶æ€æ§åˆ¶æ‰§è¡Œæµç¨‹
3. **å¤±è´¥é‡è¯•** - å¤±è´¥ä»»åŠ¡ä¿æŒå¾…æ‰§è¡ŒçŠ¶æ€ï¼Œä¾¿äºé‡è¯•
4. **æ—¥å¿—è®°å½•** - è¯¦ç»†è®°å½•æ‰§è¡Œè¿‡ç¨‹ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜
5. **å®šæœŸæ¸…ç†** - å®šæœŸæ¸…ç†å†å²æ•°æ®ï¼Œé¿å…æ•°æ®åº“è†¨èƒ€

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `å®Œæ•´ä½¿ç”¨æŒ‡å—.md` - è¯¦ç»†ä½¿ç”¨è¯´æ˜
- `README_æ–°æ¶æ„ä½¿ç”¨æŒ‡å—.md` - æ¶æ„è®¾è®¡æ–‡æ¡£
- `æ–°æ¶æ„æ€»ç»“.md` - æ¶æ„æ€»ç»“
- `æœ€ç»ˆéªŒè¯æŠ¥å‘Š.md` - æµ‹è¯•æŠ¥å‘Š

---

## ğŸ“… æ›´æ–°æ—¥å¿—

### 2025-10-03
- âœ… åˆ›å»ºæ¶æ„æ–‡æ¡£
- âœ… æ·»åŠ  chat ä»»åŠ¡é…ç½®ï¼ˆT-1ï¼‰
- âœ… å®Œæˆ124å®¶åº—é“ºå®Œæ•´æµ‹è¯•
- âœ… éªŒè¯ä»»åŠ¡çŠ¶æ€ç®¡ç†é€»è¾‘

---

**ç»´æŠ¤è€…ï¼š** AI Assistant  
**æœ€åæ›´æ–°ï¼š** 2025-10-03

